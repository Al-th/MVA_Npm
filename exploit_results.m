clear; clc;
gt = [-10,10,3,0.1,-0.05,0.03];

%Read results from files
list_files_sicp = dir('./Test/info_dmax_bunny_sicp_0.*.mat');
list_files_gicp = dir('./Test/info_dmax_bunny_gicp_0.*.mat');
nb_files = length(list_files_sicp);
dMax = zeros(nb_files,1);
average_error = zeros(nb_files,2);
time = zeros(nb_files,2);
evolution_transformation = [];
estimate_T = [];
mean_size_subset = zeros(nb_files,2);
nb_iter = zeros(nb_files,2);
for id = 1:nb_files
    results = load(['./Test/',list_files_sicp(id).name]);
    results = results.info_sicp;
    dMax(id) = results.dMax;
    average_error(id,1) = results.average_error;
    time(id,1) = results.time;
    nb_iter(id,1) = size(results.size_subset,2);
    mean_size_subset(id,1) = mean(results.size_subset);
    evol = results.evolution_transformation;
    evol(:,1:3) = radtodeg(evol(:,1:3));

    figure(1);
    plot(evol(:,1)-gt(1),'r');
    hold on;
    plot(evol(:,2)-gt(2),'r');
    plot(evol(:,3)-gt(3),'r');
    hold off;
    
    figure(2);
    plot(evol(:,4)-gt(4),'r');
    hold on; 
    plot(evol(:,5)-gt(5),'r');
    plot(evol(:,6)-gt(6),'r');
    hold off;
    
    figure(3);
    plot(results.size_subset,'r');
    
    results = load(['./Test/',list_files_gicp(id).name]);
    results = results.info_gicp;
    average_error(id,2) = results.average_error;
    time(id,2) = results.time;
    nb_iter(id,2) = size(results.size_subset,2);
    mean_size_subset(id,2) = mean(results.size_subset);
    
    evol = results.evolution_transformation;
    evol(:,1:3) = radtodeg(evol(:,1:3));

    figure(1);
    hold on;
    plot(evol(:,1)-gt(1),'b');
    plot(evol(:,2)-gt(2),'b');
    plot(evol(:,3)-gt(3),'b');
    hold off;
    
    figure(2);
    hold on;
    plot(evol(:,4)-gt(4),'b');
    plot(evol(:,5)-gt(5),'b');
    plot(evol(:,6)-gt(6),'b');
    hold off;
    
    figure(3);
    hold on;
    plot(results.size_subset,'b');
    hold off;
    
    pause()
end
%%
figure(4);
hold on;
plot(dMax(2:end),average_error(2:end,1),'r');
plot(dMax(2:end),average_error(2:end,2),'b');
hold off;
%%
figure(5);
hold on;
plot(dMax(2:end),time(2:end,1),'r');
plot(dMax(2:end),time(2:end,2),'b');
hold off;
%%
figure(6);
hold on;
plot(dMax(2:end),nb_iter(2:end,1),'r');
plot(dMax(2:end),nb_iter(2:end,2),'b');
hold off;
%%
figure(7);
hold on;
plot(dMax(1:end),mean_size_subset(1:end,1),'r');
plot(dMax(1:end),mean_size_subset(1:end,2),'b');
hold off;
